<!DOCTYPE html>
<html lang="en">


<meta http-equiv="content-type" content="text/html;charset=UTF-8" />

<head>

    <meta name="google-site-verification" content="OoM2GuIbyW9r8Zi1ygTJJZ8N2I1mOwfgVhagiZYSPtY" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-356QPR0VTP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-356QPR0VTP');
    </script>
    
    
    
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-M2NQNR6J');</script>
    <!-- End Google Tag Manager -->

     <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="author" content="trivlogic">

  <link rel="shortcut icon" href="images/stayrare/fav.png" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.gstatic.com/">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Allura&amp;display=swap" rel="stylesheet">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="/css/plugins/swiper.min.css" type="text/css">
  <link rel="stylesheet" href="/css/plugins/jquery.fancybox.css" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
<link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Document Title -->
  <title>Checkout | STAY RARE</title>
    <style>
                .icon-container {
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .icon {
            position: relative;
            width: 20px;
            height:20px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .icon:hover {
            transform: scale(1.1);
        }

        .icon-svg {
            width: 100%;
            height: 100%;
            display: block;
        }

        .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #3B1D58;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
            border: 2px solid #f5f5f5;
        }

        .icon:nth-child(2) .badge {
            background: #ef4444;
        }

        .icon:nth-child(3) .badge {
            background: #3B1D58;
        }

        :root {
            --primary-color: #3B1D58;
            --primary-hover: #3B1D58;
            --text-color: #1f2937;
            --light-text: #6b7280;
            --border-color: #e5e7eb;
            --bg-color: #f9fafb;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --radius: 0.5rem;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Main Content */
        .page-content {
            padding: 2rem 0;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--text-color);
        }

        .title-sub {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        /* Layout */
        .checkout-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 992px) {
            .checkout-layout {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* Address Selection */
        .address-selection {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .address-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .address-card {
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            padding: 1.25rem;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .address-card:hover {
            border-color: var(--primary-color);
        }

        .address-card.selected {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 1px var(--primary-color);
        }

        .address-card h5 {
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .address-card p {
            margin-bottom: 0.25rem;
            color: var(--light-text);
            font-size: 0.875rem;
        }

        .address-badge {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: var(--primary-color);
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
        }

        .use-address-btn {
            margin-top: 0.75rem;
            background: none;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 0.375rem 0.75rem;
            border-radius: var(--radius);
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .use-address-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: border-color 0.2s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 1px var(--primary-color);
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }

        .checkbox-input {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: var(--primary-color);
            cursor: pointer;
        }

        /* Order Summary */
        .order-summary {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            position: sticky;
            top: 1rem;
        }

        .order-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
        }

        .order-table th,
        .order-table td {
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
            text-align: left;
        }

        .order-table th {
            font-weight: 600;
        }

        .order-table tfoot th {
            font-weight: 700;
        }

        .order-table tfoot tr:last-child th,
        .order-table tfoot tr:last-child td {
            border-bottom: none;
            font-size: 1.125rem;
        }

        .product-name {
            font-weight: 500;
        }

        .product-name small {
            color: var(--light-text);
            font-size: 0.875rem;
        }

        /* Payment Methods */
        .payment-methods {
            margin-top: 1.5rem;
        }

        .payment-card {
            border: 1px solid var(--border-color);
            border-radius: var(--radius);
            margin-bottom: 0.75rem;
            overflow: hidden;
        }

        .payment-header {
            padding: 1rem;
            background-color: var(--bg-color);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .payment-header:hover {
            background-color: #f3f4f6;
        }

        .payment-body {
            padding: 1rem;
            display: none;
        }

        .payment-body.expanded {
            display: block;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 10px 5px;
            border-radius: var(--radius);
            font-weight: 500;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-hover);
            color: yellow;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .btn-link {
            background: none;
            border: none;
            color: var(--primary-color);
            text-decoration: underline;
            cursor: pointer;
            padding: 0;
        }

        /* Coupon Section */
        .coupon-toggle {
            margin-bottom: 1rem;
        }

        .coupon-content {
            background: white;
            padding: 1.5rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
        }

        .input-wrapper-inline {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        /* Alerts */
        .alert {
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            margin-bottom: 1rem;
        }

        .alert-success {
            background-color: #ecfdf5;
            color: var(--success-color);
            border: 1px solid #a7f3d0;
        }

        .alert-error {
            background-color: #fef2f2;
            color: var(--error-color);
            border: 1px solid #fecaca;
        }

        /* Utility Classes */
        .mt-1 {
            margin-top: 0.25rem;
        }

        .mt-2 {
            margin-top: 0.5rem;
        }

        .mt-3 {
            margin-top: 0.75rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mt-5 {
            margin-top: 1.5rem;
        }

        .mb-1 {
            margin-bottom: 0.25rem;
        }

        .mb-2 {
            margin-bottom: 0.5rem;
        }

        .mb-3 {
            margin-bottom: 0.75rem;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mb-5 {
            margin-bottom: 1.5rem;
        }

        .hidden {
            display: none;
        }
    </style>
    <style>
        /* Modal Styles */
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: #fff;
            border-radius: 8px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 1.5rem;
            color: #333;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .form-text {
            display: block;
            margin-top: 5px;
            font-size: 0.8rem;
            color: #666;
        }
        


    </style>

</head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M2NQNR6J"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag ManagerÂ (noscript)Â -->
  <div class="header-mobile header_sticky">
    <div class="container d-flex align-items-center h-100">
      <a class="mobile-nav-activator d-block position-relative"  href="#">
        <img style="height: 30px; width: 30px;" class="menu-icn nav-icon" src="/images/menu.png" alt="">
        <div class="btn-close-lg position-absolute top-0 start-0 w-100 cls-btn"></div>
      </a>

      <div class="logo">
        <a href="/">
          <img src="images/stayrare/logo.png" alt="stayrare" class="logo__image d-block">
        </a>
      </div><!-- /.logo -->

      <a href="/cart" class="header-tools__item header-tools__cart " >
           <div class="icon">
            <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                <line x1="3" y1="6" x2="21" y2="6"/>
                <path d="M16 10a4 4 0 0 1-8 0"/>
            </svg>
        
        </div>
      </a>
    </div><!-- /.container -->

    <nav class="header-mobile__navigation navigation d-flex flex-column w-100 position-absolute top-100 bg-body overflow-auto">
 

      <div class="container">
        <div class="overflow-hidden">
          <ul class="navigation__list list-unstyled position-relative">
            <li class="navigation__item">
              <a href="/" class="navigation__link js-nav-right d-flex align-items-center">Home</a>
       
            </li>
            <li class="navigation__item">
              <a style="display: flex; justify-content: space-between!important;" href="#" class="navigation__link js-nav-right d-flex align-items-center justify-between">Store <span><i class="ri-arrow-right-s-line"></i></span></a>
              <div class="sub-menu position-absolute top-0 start-100 w-100 d-none">
                <a href="#" class="navigation__link js-nav-left d-flex align-items-center border-bottom mb-3"><i class="ri-arrow-left-s-line"></i>Store</a>
              <div class="sub-menu__wrapper">
                  <% if (typeof categories !== 'undefined' && categories.length) { %>
                    <% categories.forEach(function(category) { %>
                      <a href="/store?category=<%= category._id %>" class="navigation__link js-nav-right d-flex align-items-center">
                        <%= category.name %>
                        <% if (category.activeSubCategories && category.activeSubCategories.length) { %>
                          <svg class="ms-auto" width="7" height="11" viewBox="0 0 7 11" xmlns="http://www.w3.org/2000/svg">
                            <use href="#icon_next_sm" />
                          </svg>
                        <% } %>
                      </a>
                      <% if (category.activeSubCategories && category.activeSubCategories.length) { %>
                        <div class="sub-menu__wrapper position-absolute top-0 start-100 w-100 d-none">
                          <a href="/store?category=<%= category._id %>" class="navigation__link js-nav-left d-flex align-items-center border-bottom mb-2">
                            <svg class="me-2" width="7" height="11" viewBox="0 0 7 11" xmlns="http://www.w3.org/2000/svg">
                              <use href="#icon_prev_sm" />
                            </svg>
                            <%= category.name %>
                          </a>
                          <ul class="sub-menu__list list-unstyled">
                            <% category.activeSubCategories.forEach(function(subcat) { %>
                              <li class="sub-menu__item">
                                <a href="/store?category=<%= category._id %>&subcategory=<%= subcat._id %>" class="menu-link menu-link_us-s">
                                  <%= subcat.name %>
                                </a>
                              </li>
                            <% }); %>
                          </ul>
                        </div>
                      <% } %>
                    <% }); %>
                  <% } else { %>
                    <span class="menu-link menu-link_us-s text-muted">No categories</span>
                  <% } %>
                </div>
              </div>
            </li>
            <li class="navigation__item">
                <a href="/about" class="navigation__link">About</a>
              </li>
              <li class="navigation__item">
                <a href="/account" class="navigation__link">Account</a>
              </li>
              <li class="navigation__item">
                <a href="/orders" class="navigation__link">Orders</a>
              </li>
              <li class="navigation__item">
                <a href="/cart" class="navigation__link">Cart</a>
              </li>
              <li class="navigation__item">
                <a href="/wishlist" class="navigation__link">Wishlist</a>
              </li>
                </li>
                     <li class="navigation__item">
              <a href="/blogs" class="navigation__link">blogs</a>
            </li>

       



   

            <li class="navigation__item">
              <a href="/contact" class="navigation__link">Contact</a>
            </li>
      
          </ul><!-- /.navigation__list -->
        </div><!-- /.overflow-hidden -->
      </div><!-- /.container -->

      <div class="border-top mobile-sidebar-social mt-auto pb-2">
        <a href="">
          <a href="<%= user ? '/account' : '/auth/login' %>">
            <div class="customer-links container  mt-4 mb-2 pb-1">
              <svg class="d-inline-block align-middle" width="20" height="20" viewBox="0 0 20 20" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <use href="#icon_user" />
              </svg>
              <span class="d-inline-block ms-2 text-uppercase align-middle fw-medium">My Account</span>
            </div>
          </a>





          <ul class="container social-links d-flex justify-content-around list-unstyled d-flex flex-wrap mb-0">
               <li>
              <a href="https://www.facebook.com/profile.php?id=61578094636322 " class="footer__social-link d-block">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0,0,256,256">
<g fill="black" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(10.66667,10.66667)"><path d="M17.525,9h-3.525v-2c0,-1.032 0.084,-1.682 1.563,-1.682h1.868v-3.18c-0.909,-0.094 -1.823,-0.14 -2.738,-0.138c-2.713,0 -4.693,1.657 -4.693,4.699v2.301h-3v4l3,-0.001v9.001h4v-9.003l3.066,-0.001z"></path></g></g>
</svg>
              </a>
            </li>
            <li>
              <a href="https://www.twitter.com/" class="footer__social-link d-block">
                <svg class="svg-icon svg-icon_x" width="14" height="13" viewBox="0 0 1200 1227" xmlns="http://www.w3.org/2000/svg" fill="currentColor">
  <path d="M 880 0 L 585 455 L 290 0 H 0 L 425 623 L 0 1227 H 290 L 585 772 L 880 1227 H 1170 L 745 623 L 1170 0 Z"/>
</svg>
              </a>
            </li>
            <li>
              <a href="https://www.instagram.com/" class="footer__social-link d-block">
               <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" height="20" viewBox="0,0,256,256">
<g fill="black" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(10.66667,10.66667)"><path d="M8,3c-2.757,0 -5,2.243 -5,5v8c0,2.757 2.243,5 5,5h8c2.757,0 5,-2.243 5,-5v-8c0,-2.757 -2.243,-5 -5,-5zM8,5h8c1.654,0 3,1.346 3,3v8c0,1.654 -1.346,3 -3,3h-8c-1.654,0 -3,-1.346 -3,-3v-8c0,-1.654 1.346,-3 3,-3zM17,6c-0.55228,0 -1,0.44772 -1,1c0,0.55228 0.44772,1 1,1c0.55228,0 1,-0.44772 1,-1c0,-0.55228 -0.44772,-1 -1,-1zM12,7c-2.757,0 -5,2.243 -5,5c0,2.757 2.243,5 5,5c2.757,0 5,-2.243 5,-5c0,-2.757 -2.243,-5 -5,-5zM12,9c1.654,0 3,1.346 3,3c0,1.654 -1.346,3 -3,3c-1.654,0 -3,-1.346 -3,-3c0,-1.654 1.346,-3 3,-3z"></path></g></g>
</svg>
              </a>
            </li>
            <li>
              <a href="https://www.youtube.com/" class="footer__social-link d-block">
                <svg class="svg-icon svg-icon_youtube" width="16" height="11" viewBox="0 0 16 11" xmlns="http://www.w3.org/2000/svg"><path d="M15.0117 1.8584C14.8477 1.20215 14.3281 0.682617 13.6992 0.518555C12.5234 0.19043 7.875 0.19043 7.875 0.19043C7.875 0.19043 3.19922 0.19043 2.02344 0.518555C1.39453 0.682617 0.875 1.20215 0.710938 1.8584C0.382812 3.00684 0.382812 5.46777 0.382812 5.46777C0.382812 5.46777 0.382812 7.90137 0.710938 9.07715C0.875 9.7334 1.39453 10.2256 2.02344 10.3896C3.19922 10.6904 7.875 10.6904 7.875 10.6904C7.875 10.6904 12.5234 10.6904 13.6992 10.3896C14.3281 10.2256 14.8477 9.7334 15.0117 9.07715C15.3398 7.90137 15.3398 5.46777 15.3398 5.46777C15.3398 5.46777 15.3398 3.00684 15.0117 1.8584ZM6.34375 7.68262V3.25293L10.2266 5.46777L6.34375 7.68262Z"/></svg>
              </a>
            </li>
          </ul>
      </div>
    </nav><!-- /.navigation -->
  </div><!-- /.header-mobile -->
        <!-- Start of Header -->
  <header id="header" class="header header-fullwidth header-transparent-bg">

    <div class="header-desk header-desk_type_2">
      <nav class="navigation d-flex">


        <ul class="navigation__list list-unstyled d-flex">
          <li class="navigation__item">
            <a href="/" class="navigation__link">Home</a>
      
          </li>
                  <li class="navigation__item">
            <a href="/store" class="navigation__link">Store</a>
      <ul class="default-menu list-unstyled">
              <% if (typeof categories !== 'undefined' && categories.length) { %>
                <% categories.forEach(function(category) { %>
                  <li class="sub-menu__item position-relative">
                    <a href="/store?category=<%= category._id %>" class="menu-link menu-link_us-s">
                      <%= category.name %>
                    </a>
                    <% if (category.activeSubCategories && category.activeSubCategories.length) { %>
                      <ul class="sub-menu list-unstyled position-absolute start-100 top-0 ms-2">
                        <% category.activeSubCategories.forEach(function(subcat) { %>
                          <li>
                            <a href="/store?category=<%= category._id %>&subcategory=<%= subcat._id %>" class="menu-link menu-link_us-s">
                              <%= subcat.name %>
                            </a>
                          </li>
                        <% }); %>
                      </ul>
                    <% } %>
                  </li>
                <% }); %>
              <% } else { %>
                <li class="sub-menu__item"><span class="menu-link menu-link_us-s text-muted">No categories</span></li>
              <% } %>
            </ul><!-- /.box-menu -->
          </li>
           <li class="navigation__item">
            <a href="/about" class="navigation__link">About</a>
          </li>
     
 
     
               <li class="navigation__item">
            <a href="/blogs" class="navigation__link">Blog</a>
    
          </li>
          <li class="navigation__item">
            <a href="/contact" class="navigation__link">Contact</a>
          </li>
        </ul><!-- /.navigation__list -->
      </nav><!-- /.navigation -->

      <div class="logo">
        <a href="/">
          <img style="top: 50%;" src="images/stayrare/logo.png" alt="Stayrare" class="logo__image d-block">
        </a>
      </div><!-- /.logo -->

      <div class="header-tools d-flex align-items-center">
     

      <div class="header-tools__item hover-container">
          <a class="" href="<%= user ? '/account' : '/auth/login' %>" data-aside="customerForms">
              <div class="icon">
            <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
            </svg>
   
        </div>
          </a>
        </div>

        <a class="header-tools__item" href="/wishlist">
             <div class="icon">
            <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
            </svg>
         
        </div>
        </a>

        <a href="/cart" class="header-tools__item header-tools__cart " >
     <div class="icon">
            <svg class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                <line x1="3" y1="6" x2="21" y2="6"/>
                <path d="M16 10a4 4 0 0 1-8 0"/>
            </svg>
 
        </div>
          
        </a>
      </div><!-- /.header__tools -->
    </div><!-- /.header-desk header-desk_type_2 -->
  </header>
        <!-- End of Header -->

        <!-- Start of Main -->
        <main class="main checkout">
            <!-- Start of Breadcrumb -->
            <nav class="breadcrumb-nav">
                <div class="container">
                    <ul class="breadcrumb shop-breadcrumb bb-no">
                        <li class="passed"><a href="/cart">Shopping Cart </a> </li>
                        <li class="active"><a href="/checkout"> / Checkout</a> </li>

                    </ul>
                </div>
            </nav>
            <!-- End of Breadcrumb -->


            <!-- Start of PageContent -->
            <main class="page-content">
                <div class="container">
                    <h1 class="title">Checkout</h1>

                    <!-- Secure Badges ON TOP -->
                    <div class="secure-badges mb-4" style="text-align:center;">
                        <div style="display:inline-flex;gap:20px;flex-wrap:wrap;align-items:center;">
                            <img src="/images/secure.png" alt="SSL Secure" style="height:38px;width:auto;"/>
                            <img src="/images/secure1.png" alt="Payment Shield" style="height:38px;width:auto;"/>
                            <span style="display:inline-flex;align-items:center;gap:6px;font-weight:700;color:#388e3c;">
                                <svg width="21" height="21" fill="none" stroke="#388e3c" stroke-width="2"><circle cx="10.5" cy="10.5" r="9.5" fill="#e5faf0"/><path d="M7.2 11.1l2.1 2.1 4.5-4.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                                100% Secure Payments
                            </span>
                            <span style="display:inline-flex;align-items:center;gap:6px;font-weight:700;color:#2167b9;">
                                <svg width="18" height="18" fill="none" stroke="#2167b9" stroke-width="2"><rect x="3" y="4.5" width="12" height="9" rx="2" fill="#e8f2ff" /><path d="M7 9.5h4" stroke="#2167b9" stroke-linecap="round"/><path d="M10.5 7.5v4" stroke="#2167b9" stroke-linecap="round"/></svg>
                                COD Payment Available
                            </span>
                        </div>
                    </div>

                    <!-- Responsive wrapper for checkout layout -->
                    <div class="checkout-layout-responsive">
                        <div class="checkout-layout">
                            <!-- Left Column - Address and Payment -->
                            <div class="checkout-left">
                                <!-- Address Section -->
                                <section class="address-selection">
                                    <h2 class="title-sub">Address Details</h2>

                                    <!-- Show this when no addresses exist -->
                                    <% if (!addresses || addresses.length===0) { %>
                                        <div class="no-addresses">
                                            <p>You don't have any saved addresses. Please add one to continue.</p>
                                            <button class="btn btn-primary" id="show-address-form">+ Add New
                                                Address</button>
                                        </div>
                                    <% } %>

                                    <!-- Show this when addresses exist -->
                                    <% if (addresses && addresses.length> 0) { %>
                                        <div class="address-options">
                                            <h3 class="title-sub mb-3">Select Billing Address</h3>
                                            <!-- Responsive horizontal scroll for address cards on small screens -->
                                            <div class="address-grid address-grid-scroll">
                                                <% addresses.forEach(address=> { %>
                                                    <div class="address-card <%= selectedBillingAddress === address._id.toString() ? 'selected' : '' %>"
                                                        data-address-id="<%= address._id %>"
                                                        data-address-type="billing">
                                                        <% if (address.isDefault) { %>
                                                            <span class="address-badge">Default</span>
                                                        <% } %>
                                                        <h5>
                                                            <%= address.name %>
                                                        </h5>
                                                        <p>
                                                            <%= address.addressLine1 %>
                                                        </p>
                                                        <% if (address.addressLine2) { %>
                                                            <p>
                                                                <%= address.addressLine2 %>
                                                            </p>
                                                        <% } %>
                                                        <p>
                                                            <%= address.city %>, <%= address.state %> - <%= address.pincode %>
                                                        </p>
                                                        <p>Phone: <%= address.phone %>
                                                        </p>
                                                        <button class="use-address-btn">
                                                            Use for Billing
                                                        </button>
                                                    </div>
                                                <% }); %>
                                            </div>

                                            <div class="form-group mt-3">
                                                <label class="checkbox-label">
                                                    <input type="checkbox" class="checkbox-input"
                                                        id="same-as-billing" checked>
                                                    Shipping address same as billing
                                                </label>
                                            </div>

                                            <div id="shipping-address-section" class="hidden">
                                                <h3 class="title-sub mb-3">Select Shipping Address</h3>
                                                <div class="address-grid address-grid-scroll">
                                                    <% addresses.forEach(address=> { %>
                                                        <div class="address-card <%= selectedShippingAddress === address._id.toString() ? 'selected' : '' %>"
                                                            data-address-id="<%= address._id %>"
                                                            data-address-type="shipping">
                                                            <% if (address.isDefault) { %>
                                                                <span class="address-badge">Default</span>
                                                            <% } %>
                                                            <h5>
                                                                <%= address.name %>
                                                            </h5>
                                                            <p>
                                                                <%= address.addressLine1 %>
                                                            </p>
                                                            <% if (address.addressLine2) { %>
                                                                <p>
                                                                    <%= address.addressLine2 %>
                                                                </p>
                                                            <% } %>
                                                            <p>
                                                                <%= address.city %>, <%= address.state %> - <%= address.pincode %>
                                                            </p>
                                                            <p>Phone: <%= address.phone %>
                                                            </p>
                                                            <button class="use-address-btn">
                                                                Use for Shipping
                                                            </button>
                                                        </div>
                                                    <% }); %>
                                                </div>
                                            </div>

                                            <div class="text-center mt-4">
                                                <button class="btn btn-primary" id="add-new-address-btn">+ Add New
                                                    Address</button>
                                            </div>
                                        </div>
                                    <% } %>
                                </section>

                                <!-- Coupon Section -->
                                <% if (cart.couponInfo && cart.couponInfo.validated) { %>
                                <section style="margin-bottom:1.5rem;">
                                    <div class="alert alert-success d-flex align-items-center flex-wrap" style="background:linear-gradient(90deg,#e0ffe7 60%,#f1fff9);border-radius:9px;padding:16px 20px;margin-bottom:0;">
                                        <svg width="28" height="28" fill="none" stroke="#1bc47d" stroke-width="2" viewBox="0 0 24 24" style="margin-right:10px;">
                                            <circle cx="12" cy="12" r="10" fill="#e5faf0"></circle>
                                            <path d="M7 13l3 3 7-7" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                        <div style="display:flex;align-items:center;gap:6px;">
                                            <div>
                                                <b>Coupon "<%= cart.couponInfo.code %>" has been successfully applied!</b><br>
                                                <span style="font-size:1.24em;font-weight:700;color:#e53935;">
                                                    <svg width="18" height="18" fill="none" stroke="#e53935" stroke-width="2" style="vertical-align:-3px;"><path d="M3 9l6 6L21 5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                                                    You saved â‚¹<%= (cart.couponInfo && cart.couponInfo.discountAmount) ? cart.couponInfo.discountAmount.toFixed(2) : '0.00' %>
                                                </span>
                                                <span style="margin-left:8px;color:#388e3c;font-size:1em;font-weight:600;">
                                                    ðŸŽ‰ Enjoy your discount!
                                                </span>
                                            </div>
                                            <button type="button" class="btn btn-danger btn-sm ml-3" id="remove-coupon" style="margin-left:20px;white-space:nowrap;">
                                                Remove
                                            </button>
                                        </div>
                                    </div>
                                </section>
                                <% } else { %>
                                <section class="coupon-toggle mb-3">
                                    Have a coupon? <button class="btn-link" id="show-coupon">Enter your code</button>
                                </section>
                                <% } %>

                                <section class="coupon-content <%= (cart.couponInfo && cart.couponInfo.validated) ? '' : 'hidden' %>" id="coupon-section">
                                    <p class="mb-3">If you have a coupon code, please apply it below.</p>
                                    <div class="input-wrapper-inline">
                                        <input type="text" name="coupon_code" class="form-control" placeholder="Coupon code"
                                            id="coupon_code" <%= (cart.couponInfo && cart.couponInfo.validated) ? 'disabled value="'+cart.couponInfo.code+'"' : '' %>>
                                        <button type="button" class="btn btn-primary" id="apply_coupon"
                                            <%= (cart.couponInfo && cart.couponInfo.validated) ? 'disabled' : '' %>>
                                            Apply
                                        </button>
                                    </div>
                                    <div id="coupon_message" class="mt-2"></div>
                                </section>

                                <!-- Coupon Success Popup (always present in DOM, shown/hidden via JS) -->
                                <div id="coupon-success-popup" class="coupon-success-popup" style="display:none;">
                                    <div class="coupon-success-popup-backdrop"></div>
                                    <div class="coupon-success-popup-content">
                                        <button class="coupon-success-popup-close" id="close-coupon-popup" aria-label="Close">&times;</button>
                                        <div class="lottie-container">
                                            <dotlottie-wc 
                                                src="https://lottie.host/95057402-7573-4448-9319-e49b74d14e81/cIpCYTLFJI.lottie"
                                                style="width:80px;height:80px;display:block;margin:0 auto;"
                                                speed="1.2" autoplay loop>
                                            </dotlottie-wc>
                                        </div>
                                        <h2 class="catchy-title" style="color:#1bc47d;font-weight:800;margin-top:10px;">
                                            Woohoo! Coupon Applied ðŸŽ‰
                                        </h2>
                                        <div class="catchy-discount" id="popup-discount-amount" style="font-size:2.2em;font-weight:900;color:#e53935;margin:10px 0;">
                                            â‚¹<%= (cart.couponInfo && cart.couponInfo.validated && cart.couponInfo.discountAmount) ? cart.couponInfo.discountAmount.toFixed(2) : '' %>
                                        </div>
                                        <div class="catchy-message" style="font-size:1.1em;color:#333;">
                                            You just saved big on your order!<br>
                                            Enjoy your extra savings and happy shopping at <span style="color:#1bc47d;font-weight:700;">StayRare</span>!
                                        </div>
                                        <button class="btn btn-success mt-3" id="popup-close-btn" style="font-size:1.1em;padding:8px 32px;border-radius:30px;background:linear-gradient(90deg,#1bc47d,#00bfae);color:#fff;font-weight:700;box-shadow:0 2px 12px #b2f5ea;">Awesome!</button>
                                    </div>
                                </div>

                                <!-- Order Notes -->
                                <section class="form-group mt-4">
                                    <label for="order-notes" class="form-label">Order notes (optional)</label>
                                    <textarea class="form-control" id="order-notes" name="order-notes" rows="4"
                                        placeholder="Notes about your order, e.g. special notes for delivery"></textarea>
                                </section>
                            </div>

                            <!-- Right Column - Order Summary -->
                            <div class="checkout-right">
                                <section class="order-summary">
                                    <h2 class="title-sub">Your Order</h2>
                                    <table class="order-table" id="order-summary-table">
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Subtotal</th>
                                            </tr>
                                        </thead>
                                        <tbody id="order-summary-tbody">
                                            <% if (cart.items && cart.items.length > 0) { %>
                                                <% cart.items.forEach(item => { %>
                                                    <tr>
                                                        <td class="product-name" style="position:relative;">
                                                            <%= item.productName %>
                                                            <% if (item.selectedColor) { %>
                                                                <br><small>Color: <%= item.selectedColor %></small>
                                                            <% } %>
                                                            <% if (item.selectedSize) { %>
                                                                <br><small>Size: <%= item.selectedSize %></small>
                                                            <% } %>
                                                            <br><small>Qty: <%= item.quantity %></small>
                                                            <br>
                                                            <% if (item.basePrice && item.salePrice && item.basePrice > item.salePrice) { %>
                                                                <span style="color:#888;text-decoration:line-through;">
                                                                    â‚¹<%= item.basePrice.toFixed(2) %>
                                                                </span>
                                                                <span style="color:#e53935;font-weight:bold;">
                                                                    â‚¹<%= item.salePrice.toFixed(2) %>
                                                                </span>
                                                                <% if (item.discountPercent && item.discountPercent > 0) { %>
                                                                    <span style="display:inline-block;vertical-align:middle;margin-left:8px;position:relative;top:-2px;">
                                                                        <span style="background:linear-gradient(90deg,#ff512f,#dd2476);color:#fff;padding:4px 10px;border-radius:30px;font-weight:bold;font-size:0.98em;box-shadow:0 2px 8px #ffb3b3;display:inline-block;">
                                                                            <%= item.discountPercent %>% OFF
                                                                        </span>
                                                                    </span>
                                                                    <br>
                                                                    <span style="color:#388e3c;font-size:0.97em;display:inline-block;margin-top:2px;">
                                                                        Youâ€™re saving <b>â‚¹<%= item.discountAmount.toFixed(2) %></b> on this item! ðŸŽ‰
                                                                    </span>
                                                                <% } %>
                                                            <% } else { %>
                                                                <span style="color:#222;font-weight:bold;">
                                                                    â‚¹<%= (item.salePrice || item.basePrice || item.price).toFixed(2) %>
                                                                </span>
                                                            <% } %>
                                                        </td>
                                                        <td>
                                                            <% 
                                                                let unitPrice = (item.salePrice && item.salePrice < item.basePrice) ? item.salePrice : (item.basePrice || item.price);
                                                                let subtotal = unitPrice * item.quantity;
                                                            %>
                                                            â‚¹<%= subtotal.toFixed(2) %>
                                                        </td>
                                                    </tr>
                                                <% }); %>
                                            <% } else { %>
                                                <tr>
                                                    <td colspan="2" id="js-guest-empty">Your cart is empty</td>
                                                </tr>
                                            <% } %>
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <th>Subtotal</th>
                                                <td id="cart-subtotal">â‚¹<%= cart.subtotal.toFixed(2) %></td>
                                            </tr>
                                          
                                            <tr id="discount-row" style="display: <%= (cart.couponInfo && cart.couponInfo.validated && cart.couponInfo.discountAmount > 0) ? '' : 'none' %>;">
                                                <th>Discount<% if (cart.couponInfo && cart.couponInfo.code) { %> (<%= cart.couponInfo.code %>)<% } %></th>
                                                <td id="discount-amount">-â‚¹<%= (cart.couponInfo && cart.couponInfo.discountAmount) ? cart.couponInfo.discountAmount.toFixed(2) : '0.00' %></td>
                                            </tr>
                                            <tr>
                                                <th>Shipping</th>
                                                <td>Free</td>
                                            </tr>
                                            <tr>
                                                <th>Total</th>
                                                <td id="cart-total">â‚¹<%= cart.total.toFixed(2) %></td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                    
                                    <!-- Payment Methods -->
                                    <div class="payment-methods">
                                        <h3 class="title-sub mb-3">Payment Method</h3>
                                        <!-- COD Option -->
                                        <input type="hidden" id="selectedPaymentMethod" value="Razorpay" />
                                        <div class="payment-card">
                                            <div class="payment-header" data-target="cod">
                                                <span>
                                                    <svg height="18" width="18" style="vertical-align:-4px;margin-right:6px;" fill="none" stroke="#2e7d32" stroke-width="2">
                                                        <rect x="3" y="4.5" width="12" height="9" rx="2" stroke="#388e3c" fill="#e8f5e9"></rect>
                                                        <path d="M7 9.5h4" stroke="#388e3c" stroke-linecap="round"/>
                                                        <path d="M10.5 7.5v4" stroke="#388e3c" stroke-linecap="round"/>
                                                    </svg>
                                                    Cash on Delivery (COD)
                                                </span>
                                                <span>â†’</span>
                                            </div>
                                            <div class="payment-body" id="cod">
                                                <p>Pay with cash when your order arrives at your doorstep.</p>
                                            </div>
                                        </div>
                                        <div class="payment-card">
                                            <div class="payment-header" data-target="credit-card">
                                                <span>Credit/Debit Card</span>
                                                <span>â†’</span>
                                            </div>
                                            <div class="payment-body" id="credit-card">
                                                <p>Pay securely using Visa, Mastercard, or RuPay cards.</p>
                                            </div>
                                        </div>
                                        <div class="payment-card">
                                            <div class="payment-header" data-target="upi">
                                                <span>UPI/Net Banking</span>
                                                <span>â†’</span>
                                            </div>
                                            <div class="payment-body" id="upi">
                                                <p>Quick payments through Google Pay, PhonePe, Paytm, or net banking.</p>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Place Order Button -->
                                    <button class="btn btn-primary btn-block mt-4" id="place-order-btn" <%=cart.items &&
                                        cart.items.length===0 ? 'disabled' : '' %>>
                                        Place Order
                                    </button>
                                    <script>
                                       
                                        document.addEventListener('DOMContentLoaded', function () {
                                          const paymentHeaders = document.querySelectorAll('.payment-header');
                                          const hiddenInput = document.getElementById('selectedPaymentMethod');
                                        
                                          paymentHeaders.forEach(header => {
                                            header.addEventListener('click', function () {
                                           
                                              paymentHeaders.forEach(h => h.classList.remove('active'));
                                              this.classList.add('active');
                                      
                                              const target = this.getAttribute('data-target');
                                              let methodName = "Razorpay"; 
                                        
                                              if (target === 'cod') methodName = "COD";
                                              else if (target === 'credit-card' || target === 'upi') methodName = "Razorpay";
                                        
                                              hiddenInput.value = methodName;
                                              console.log("Selected Payment Method:", methodName);
                                            });
                                          });
                                        });

                            
                                        document.addEventListener('DOMContentLoaded', function () {
                                     
                                            var isGuest = <%= user ? 'false' : 'true' %>;
                                            if (isGuest) {
                                                let guestCartArr;
                                                try {
                                                    guestCartArr = JSON.parse(localStorage.getItem('cart') || '[]');
                                                } catch (e) {
                                                    guestCartArr = [];
                                                }
                                                var tbody = document.getElementById('order-summary-tbody');
                                                var subtotal = 0;
                                                var html = '';
                                                if (Array.isArray(guestCartArr) && guestCartArr.length > 0) {
                                                    guestCartArr.forEach(function(item) {
                                                        var unit = item.price;
                                                        var rowSubtotal = unit * item.quantity;
                                                        subtotal += rowSubtotal;
                                                        html += `
                                                            <tr>
                                                                <td class="product-name" style="position:relative;">
                                                                    ${item.productName || ''}
                                                                    ${item.selectedColor ? `<br><small>Color: ${item.selectedColor}</small>` : ''}
                                                                    ${item.selectedSize ? `<br><small>Size: ${item.selectedSize}</small>` : ''}
                                                                    <br><small>Qty: ${item.quantity}</small>
                                                                    <br>
                                                                    <span style="color:#222;font-weight:bold;">
                                                                        â‚¹${unit.toFixed(2)}
                                                                    </span>
                                                                </td>
                                                                <td>
                                                                    â‚¹${rowSubtotal.toFixed(2)}
                                                                </td>
                                                            </tr>
                                                        `;
                                                    });
                                                } else {
                                                    html = '<tr><td colspan="2">Your cart is empty</td></tr>';
                                                }
                                                if (tbody) {
                                                    tbody.innerHTML = html;
                                                }
                                                // Update subtotal, shipping, total
                                                var subtotalEl = document.getElementById('cart-subtotal');
                                                var totalEl = document.getElementById('cart-total');
                                                if (subtotalEl) subtotalEl.textContent = 'â‚¹' + subtotal.toFixed(2);
                                                if (totalEl) totalEl.textContent = 'â‚¹' + subtotal.toFixed(2);

                                                // Remove coupon and discount rows for guest
                                                var discountRow = document.getElementById('discount-row');
                                                if (discountRow) discountRow.style.display = 'none';
                                            }
                                        });

                                        // Remove coupon logic
                                        document.addEventListener('DOMContentLoaded', function () {
                                            const removeBtn = document.getElementById('remove-coupon');
                                            if (removeBtn) {
                                                removeBtn.addEventListener('click', async function () {
                                                    removeBtn.disabled = true;
                                                    removeBtn.textContent = 'Removing...';
                                                    try {
                                                        const res = await fetch('/remove-coupon', {
                                                            method: 'POST',
                                                            headers: { 'Content-Type': 'application/json' },
                                                            credentials: 'include'
                                                        });
                                                        const result = await res.json();
                                                        if (result.success) {
                                                            window.location.reload();
                                                        } else {
                                                            alert(result.message || 'Failed to remove coupon');
                                                            removeBtn.disabled = false;
                                                            removeBtn.textContent = 'Remove';
                                                        }
                                                    } catch (err) {
                                                        alert('Failed to remove coupon.');
                                                        removeBtn.disabled = false;
                                                        removeBtn.textContent = 'Remove';
                                                    }
                                                });
                                            }
                                        });

                                        // Coupon Apply Logic, show discount row immediately
                                        document.addEventListener('DOMContentLoaded', function () {
                                            const applyCouponBtn = document.getElementById('apply_coupon');
                                            if (applyCouponBtn) {
                                                applyCouponBtn.addEventListener('click', async function (e) {
                                                    e.preventDefault();
                                                    const couponCodeInput = document.getElementById('coupon_code');
                                                    const couponMessage = document.getElementById('coupon_message');
                                                    const couponCode = couponCodeInput.value.trim();
                                                    couponMessage.innerHTML = '';
                                                    if (!couponCode) {
                                                        couponMessage.innerHTML = '<div class="alert alert-error">Please enter a coupon code</div>';
                                                        return;
                                                    }
                                                    applyCouponBtn.disabled = true;
                                                    applyCouponBtn.textContent = 'Applying...';
                                                    try {
                                                        const response = await fetch('/apply-coupon', {
                                                            method: 'POST',
                                                            headers: { 'Content-Type': 'application/json' },
                                                            body: JSON.stringify({ couponCode })
                                                        });
                                                        if (!response.ok) {
                                                            const errorResult = await response.json().catch(() => null);
                                                            const errMsg = errorResult?.message || 'Network error applying coupon';
                                                            couponMessage.innerHTML = `<div class="alert alert-error">${errMsg}</div>`;
                                                        } else {
                                                            const result = await response.json();
                                                            if (result.success && result.cart) {
    couponMessage.innerHTML = '<div class="alert alert-success">Coupon applied successfully!</div>';
    
    // Update all amounts
    if (result.cart.subtotal && document.getElementById('cart-subtotal')) {
        document.getElementById('cart-subtotal').textContent = "â‚¹" + Number(result.cart.subtotal).toFixed(2);
    }
    if (document.getElementById('cart-total')) {
        document.getElementById('cart-total').textContent = "â‚¹" + Number(result.cart.total).toFixed(2);
    }
    const discountRow = document.getElementById('discount-row');
    if (discountRow && result.cart.couponInfo && result.cart.couponInfo.validated) {
        const discountAmount = result.cart.couponInfo.discountAmount || 0;
        if (discountAmount > 0) {
            discountRow.style.display = "";
            const th = discountRow.querySelector('th');
            if (th && result.cart.couponInfo.code) {
                th.textContent = `Discount (${result.cart.couponInfo.code})`;
            }
            const tdd = discountRow.querySelector('td#discount-amount');
            if (tdd) {
                tdd.textContent = "-â‚¹" + Number(discountAmount).toFixed(2);
            }
        }
    }
    
    showCouponSuccessPopup(result.cart.couponInfo?.discountAmount, couponCode);
    setTimeout(() => window.location.reload(), 900);
}
                                                             else {
                                                                couponMessage.innerHTML = `<div class="alert alert-error">${result.message || 'Failed to apply coupon'}</div>`;
                                                            }
                                                        }
                                                    } catch (error) {
                                                        console.error('Coupon application error:', error);
                                                        couponMessage.innerHTML = '<div class="alert alert-error">Failed to apply coupon. Please try again.</div>';
                                                    } finally {
                                                        applyCouponBtn.disabled = false;
                                                        applyCouponBtn.textContent = 'Apply Coupon';
                                                    }
                                                });
                                            }
                                        });

                                        function showCouponSuccessPopup(discountAmount, coupon) {
                                            const popup = document.getElementById('coupon-success-popup');
                                            const popupAmt = document.getElementById('popup-discount-amount');
                                            if (discountAmount && !isNaN(discountAmount) && Number(discountAmount) > 0) {
                                                popupAmt.textContent = `â‚¹${Number(discountAmount).toFixed(2)}`;
                                            } else {
                                                popupAmt.textContent = '';
                                            }
                                            popup.style.display = 'flex';
                                            const closePopup = () => { popup.style.display = 'none'; };
                                            document.getElementById('close-coupon-popup').onclick = closePopup;
                                            document.getElementById('popup-close-btn').onclick = closePopup;
                                            popup.querySelector('.coupon-success-popup-backdrop').onclick = closePopup;
                                        }

                                        // updateCartTotals left untouched but ensure that discount row works for immediate DOM update
                                        function updateCartTotals(cart) {
    const subtotalElement = document.getElementById('cart-subtotal');
    if (subtotalElement && cart && typeof cart.subtotal === "number") {
        subtotalElement.textContent = `â‚¹${cart.subtotal.toFixed(2)}`;
    }
    
    const discountRow = document.getElementById('discount-row');
    if (discountRow) {
        const discountAmount = cart.couponInfo?.discountAmount || 0;
        const isValidated = cart.couponInfo?.validated;
        
        if (isValidated && discountAmount > 0) {
            discountRow.style.display = '';
            discountRow.querySelector('th').textContent = `Discount (${cart.couponInfo.code})`;
            discountRow.querySelector('td').textContent = `-â‚¹${discountAmount.toFixed(2)}`;
        } else {
            discountRow.style.display = 'none';
        }
    }
    
    const totalElement = document.getElementById('cart-total');
    if (totalElement && cart && typeof cart.total === "number") {
        totalElement.textContent = `â‚¹${cart.total.toFixed(2)}`;
    }
}


                                        // ====== PLACE ORDER LOGIC ======
                                        const placeOrderBtn = document.getElementById('place-order-btn');
                                        if (placeOrderBtn) {
                                            placeOrderBtn.addEventListener('click', async function (e) {
                                                e.preventDefault();

                                                const billingAddressId = document.getElementById('billingAddressId').value;
                                                const shippingAddressId = document.getElementById('shippingAddressId').value;

                                                // Get selected payment method
                                                const paymentMethod = document.getElementById('selectedPaymentMethod').value || "Razorpay";

                                                if (!billingAddressId || !shippingAddressId) {
                                                    alert('Please select both billing and shipping addresses');
                                                    return;
                                                }

                                                // For guest: get total from localStorage cart if available
                                                var isGuest = <%= user ? 'false' : 'true' %>;
                                                let totalAmount;
                                                if (isGuest) {
                                                    let guestCartArr;
                                                    try {
                                                        guestCartArr = JSON.parse(localStorage.getItem('cart') || '[]');
                                                    } catch (e) {
                                                        guestCartArr = [];
                                                    }
                                                    totalAmount = 0;
                                                    if (Array.isArray(guestCartArr) && guestCartArr.length > 0) {
                                                        guestCartArr.forEach(function(item) {
                                                            totalAmount += Number(item.price) * Number(item.quantity);
                                                        });
                                                    }
                                                } else {
                                                    const totalText = document.getElementById('cart-total') ? document.getElementById('cart-total').innerText : '';
                                                    totalAmount = parseFloat(totalText.replace(/[^\d.-]/g, ''));
                                                }
                                                if (isNaN(totalAmount) || totalAmount <= 0) {
                                                    alert('Invalid total amount!');
                                                    return;
                                                }

                                                const submitBtn = this;
                                                submitBtn.disabled = true;
                                                submitBtn.textContent = 'Processing...';

                                                try {
                                                    const response = await fetch('/place-order', {
                                                        method: 'POST',
                                                        headers: { 'Content-Type': 'application/json' },
                                                        credentials: 'include',
                                                        body: JSON.stringify({
                                                            billingAddressId,
                                                            shippingAddressId,
                                                            totalAmount,
                                                            paymentMethod,
                                                            notes: document.getElementById('order-notes') ? document.getElementById('order-notes').value : ""
                                                        })
                                                    });

                                                    const data = await response.json();

                                                    // Cash on Delivery
                                                    if (data.success && data.cod) {
                                                        // For COD orders, no Razorpay popup
                                                        const confirmRes = await fetch('/confirm-order', {
                                                            method: 'POST',
                                                            headers: { 'Content-Type': 'application/json' },
                                                            body: JSON.stringify({
                                                                billingAddressId,
                                                                shippingAddressId,
                                                                paymentMethod: "COD"
                                                            })
                                                        });

                                                        const confirmData = await confirmRes.json();
                                                        if (confirmData.success) {
                                                            window.location.href = `/order-confirmation/${confirmData.orderId}`;
                                                        } else {
                                                            alert(confirmData.message || "Failed to confirm COD order");
                                                        }
                                                        return;
                                                    }

                                                    // Online Payment (Razorpay)
                                                    if (data.success && !data.cod) {
                                                        const options = {
                                                            key: data.key,
                                                            amount: data.amount,
                                                            currency: data.currency,
                                                            name: "Stayrare",
                                                            description: "Order Payment",
                                                            order_id: data.razorpayOrderId,
                                                            handler: async function (response) {
                                                                const confirmRes = await fetch('/confirm-order', {
                                                                    method: 'POST',
                                                                    headers: { 'Content-Type': 'application/json' },
                                                                    body: JSON.stringify({
                                                                        razorpay_payment_id: response.razorpay_payment_id,
                                                                        razorpay_order_id: response.razorpay_order_id,
                                                                        razorpay_signature: response.razorpay_signature,
                                                                        billingAddressId,
                                                                        shippingAddressId,
                                                                        paymentMethod: "Online"
                                                                    })
                                                                });
                                                                const confirmData = await confirmRes.json();
                                                                if (confirmData.success) {
                                                                    window.location.href = `/order-confirmation/${confirmData.orderId}`;
                                                                } else {
                                                                    alert('Payment succeeded but order creation failed!');
                                                                }
                                                            },
                                                            theme: { color: "#001F3F" }
                                                        };

                                                        const rzp = new Razorpay(options);
                                                        rzp.open();
                                                    } else {
                                                        alert(data.message || 'Failed to create Razorpay order!');
                                                    }

                                                } catch (error) {
                                                    console.error('Order placement error:', error);
                                                    alert('An error occurred while placing your order');
                                                } finally {
                                                    submitBtn.disabled = false;
                                                    submitBtn.textContent = 'Place Order';
                                                }
                                            });
                                        }
                                    </script>
                                        
                                </section>
                            </div>
                        </div>
                    </div>

                    <!-- Hidden fields for selected addresses -->
                    <input type="hidden" name="billingAddressId" id="billingAddressId"
                        value="<%= defaultAddress ? defaultAddress._id : '' %>">
                    <input type="hidden" name="shippingAddressId" id="shippingAddressId"
                        value="<%= defaultAddress ? defaultAddress._id : '' %>">
                </div>
            </main>
            <div id="address-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Add New Address</h3>
                        <button type="button" class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="address-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="name" class="form-label">Full Name*</label>
                                    <input type="text" class="form-control" id="name" name="name" required>
                                </div>
                                <div class="form-group">
                                    <label for="email" class="form-label">Email*</label>
                                    <input type="email" class="form-control" id="email" name="email" required>
                                    <small class="form-text">We'll never share your email with anyone else.</small>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="phone" class="form-label">Mobile Number*</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" required
                                        pattern="[6-9]{1}[0-9]{9}" maxlength="10">
                                    <small class="form-text">10-digit Indian mobile number</small>
                                </div>
                                <div class="form-group">
                                    <label for="pincode" class="form-label">Pincode*</label>
                                    <input type="text" class="form-control" id="pincode" name="pincode" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="state" class="form-label">State*</label>
                                    <input type="text" class="form-control" id="state" name="state" required>
                                </div>
                                <div class="form-group">
                                    <label for="city" class="form-label">City*</label>
                                    <input type="text" class="form-control" id="city" name="city" required>
                                </div>
                                <div class="form-group">
                                    <label for="district" class="form-label">District</label>
                                    <input type="text" class="form-control" id="district" name="district">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="addressLine1" class="form-label">Address Line 1*</label>
                                <input type="text" class="form-control" id="addressLine1" name="addressLine1" required>
                                <small class="form-text">Street address, P.O. box, company name</small>
                            </div>
                            <div class="form-group">
                                <label for="addressLine2" class="form-label">Address Line 2</label>
                                <input type="text" class="form-control" id="addressLine2" name="addressLine2">
                                <small class="form-text">Apartment, suite, unit, building, floor, etc.</small>
                            </div>
                            <div class="form-group">
                                <label for="landmark" class="form-label">Landmark</label>
                                <input type="text" class="form-control" id="landmark" name="landmark">
                                <small class="form-text">Nearby location for easier delivery</small>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="addressType" class="form-label">Address Type</label>
                                    <select class="form-control" id="addressType" name="addressType">
                                        <option value="Home">Home</option>
                                        <option value="Work">Work</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" class="checkbox-input" id="isDefault" name="isDefault">
                                        Set as default address
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" id="cancel-address">Cancel</button>
                        <button type="button" class="btn btn-primary" id="save-address">Save Address</button>
                    </div>
                </div>
            </div>
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    // === ADDRESS MODAL LOGIC ===
                    const addressModal = document.getElementById('address-modal');
                    document.getElementById('show-address-form')?.addEventListener('click', () => addressModal.classList.add('active'));
                    document.getElementById('add-new-address-btn')?.addEventListener('click', () => addressModal.classList.add('active'));
                    document.querySelector('.modal-close')?.addEventListener('click', () => addressModal.classList.remove('active'));
                    document.getElementById('cancel-address')?.addEventListener('click', () => addressModal.classList.remove('active'));
    
                    // Save new address (handles both registered and guest flow)
                    document.getElementById('save-address')?.addEventListener('click', async function () {
                        const form = document.getElementById('address-form');
                        const formData = {
                            name: form.querySelector('#name').value.trim(),
                            email: form.querySelector('#email').value.trim(),
                            phone: form.querySelector('#phone').value.trim(),
                            pincode: form.querySelector('#pincode').value.trim(),
                            state: form.querySelector('#state').value.trim(),
                            city: form.querySelector('#city').value.trim(),
                            district: form.querySelector('#district').value.trim() || '',
                            addressLine1: form.querySelector('#addressLine1').value.trim(),
                            addressLine2: form.querySelector('#addressLine2').value.trim() || '',
                            landmark: form.querySelector('#landmark').value.trim() || '',
                            addressType: form.querySelector('#addressType').value,
                            isDefault: form.querySelector('#isDefault').checked
                        };
    
                        // Basic Validation
                        if (!formData.name || !formData.email || !formData.phone || !formData.pincode ||
                            !formData.state || !formData.city || !formData.addressLine1) {
                            alert('Please fill in all required fields');
                            return;
                        }
                        if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)) {
                            alert('Please enter a valid email address');
                            return;
                        }
                        if (!/^[6-9]\d{9}$/.test(formData.phone)) {
                            alert('Please enter a valid 10-digit Indian mobile number');
                            return;
                        }
                        if (!/^\d{6}$/.test(formData.pincode)) {
                            alert('Please enter a valid 6-digit pincode');
                            return;
                        }
    
                        // Attach guest cart if any (for guest checkout)
                        const guestCart = JSON.parse(localStorage.getItem('cart') || '[]');
                        if (guestCart.length > 0) {
                            formData.cartItems = guestCart.map(item => ({
                                product: item.productId,
                                name: item.productName,
                                image: item.productImage,
                                price: item.price,
                                quantity: item.quantity,
                                selectedColor: item.selectedColor || null,
                                selectedMeasurement: item.selectedSize || null,
                                total: item.total
                            }));
                        }
    
                        try {
                            const saveBtn = this;
                            saveBtn.disabled = true;
                            saveBtn.textContent = 'Saving...';
    
                            // Route works for both guest and user
                            const response = await fetch('/create-address', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(formData)
                            });
    
                            const result = await response.json();
    
                            if (response.ok) {
                                // On success, clear guest cart if present
                                localStorage.removeItem('cart');
                                addressModal.classList.remove('active');
                                window.location.reload();
                            } else {
                                alert(result.message || 'Failed to save address');
                            }
                        } catch (err) {
                            console.error('Error saving address:', err);
                            alert('Failed to save address. Please try again.');
                        } finally {
                            const saveBtn = this;
                            if (saveBtn) {
                                saveBtn.disabled = false;
                                saveBtn.textContent = 'Save Address';
                            }
                        }
                    });
    
                    // Coupon area toggling
                    const couponToggle = document.getElementById('show-coupon');
                    if (couponToggle) {
                        couponToggle.addEventListener('click', function (e) {
                            e.preventDefault();
                            document.getElementById('coupon-section').classList.toggle('hidden');
                        });
                    }
    
                    // Address selection logic
                    document.querySelectorAll('.use-address-btn').forEach(button => {
                        button.addEventListener('click', function (e) {
                            e.preventDefault();
                            const addressCard = this.closest('.address-card');
                            const addressId = addressCard.dataset.addressId;
                            const addressType = addressCard.dataset.addressType;
    
                            document.querySelectorAll(`.address-card[data-address-type="${addressType}"]`).forEach(card => {
                                card.classList.remove('selected');
                            });
                            addressCard.classList.add('selected');
                            document.getElementById(`${addressType}AddressId`).value = addressId;
    
                            if (addressType === 'billing' && document.getElementById('same-as-billing').checked) {
                                document.getElementById('shippingAddressId').value = addressId;
                                document.querySelectorAll('.address-card[data-address-type="shipping"]').forEach(card => {
                                    card.classList.remove('selected');
                                    if (card.dataset.addressId === addressId) {
                                        card.classList.add('selected');
                                    }
                                });
                            }
                        });
                    });
    
                    // Same as billing checkbox
                    const sameAsBillingCheckbox = document.getElementById('same-as-billing');
                    if (sameAsBillingCheckbox) {
                        sameAsBillingCheckbox.addEventListener('change', function () {
                            const shippingContainer = document.getElementById('shipping-address-section');
                            if (this.checked) {
                                shippingContainer.classList.add('hidden');
                                const billingAddressId = document.getElementById('billingAddressId').value;
                                document.getElementById('shippingAddressId').value = billingAddressId;
                                document.querySelectorAll('.address-card[data-address-type="shipping"]').forEach(card => {
                                    card.classList.remove('selected');
                                    if (card.dataset.addressId === billingAddressId) {
                                        card.classList.add('selected');
                                    }
                                });
                            } else {
                                shippingContainer.classList.remove('hidden');
                            }
                        });
                    }
    
                    // Payment method accordion logic
                    document.querySelectorAll('.payment-header').forEach(header => {
                        header.addEventListener('click', function () {
                            const targetId = this.dataset.target;
                            const target = document.getElementById(targetId);
    
                            if (!target) return;
                            document.querySelectorAll('.payment-body').forEach(body => {
                                if (body.id !== targetId) {
                                    body.classList.remove('expanded');
                                    const arrow = body.closest('.payment-card')?.querySelector('.payment-header span:last-child');
                                    if (arrow) arrow.textContent = 'â†’';
                                }
                            });
    
                            target.classList.toggle('expanded');
                            const arrow = this.querySelector('span:last-child');
                            if (arrow) {
                                arrow.textContent = target.classList.contains('expanded') ? 'â†“' : 'â†’';
                            }
                        });
                    });
                });
            </script>
            <style>
                /* Responsive checkout layout for mobile */
                .checkout-layout {
                    display: flex;
                    gap: 32px;
                }
                .checkout-left, .checkout-right {
                    flex: 1 1 0;
                    min-width: 0;
                }
                /* Address grid scroll for mobile */
                .address-grid.address-grid-scroll {
                    display: flex;
                    flex-wrap: wrap;
                    gap: 16px;
                }
                @media (max-width: 991.98px) {
                    .checkout-layout {
                        flex-direction: column;
                        gap: 24px;
                    }
                    .checkout-left, .checkout-right {
                        width: 100%;
                        min-width: 0;
                    }
                    .address-grid.address-grid-scroll {
                        flex-wrap: nowrap;
                        overflow-x: auto;
                        -webkit-overflow-scrolling: touch;
                        gap: 12px;
                        padding-bottom: 8px;
                    }
                    .address-card {
                        min-width: 260px;
                        max-width: 90vw;
                        flex: 0 0 auto;
                    }
                }
                @media (max-width: 575.98px) {
                    .address-card {
                        min-width: 220px;
                        max-width: 95vw;
                    }
                }
                /* Coupon Success Pop-up Styles (from your popup CSS) */
                .coupon-success-popup {
                    position: fixed;
                    z-index: 9999;
                    left: 0; top: 0; right: 0; bottom: 0;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                .coupon-success-popup-backdrop {
                    position: absolute;
                    left: 0; top: 0; right: 0; bottom: 0;
                    background: rgba(0,0,0,0.45);
                    z-index: 0;
                }
                .coupon-success-popup-content {
                    position: relative;
                    background: #fff;
                    border-radius: 18px;
                    box-shadow: 0 8px 32px rgba(0,0,0,0.18);
                    padding: 36px 32px 28px 32px;
                    min-width: 320px;
                    max-width: 95vw;
                    text-align: center;
                    z-index: 1;
                    animation: popIn 0.35s cubic-bezier(.68,-0.55,.27,1.55);
                }
                @keyframes popIn {
                    0% { transform: scale(0.7); opacity: 0; }
                    80% { transform: scale(1.08); opacity: 1; }
                    100% { transform: scale(1); }
                }
                .coupon-success-popup-close {
                    position: absolute;
                    top: 12px; right: 16px;
                    background: none;
                    border: none;
                    font-size: 2em;
                    color: #aaa;
                    cursor: pointer;
                    z-index: 2;
                    transition: color 0.2s;
                }
                .coupon-success-popup-close:hover {
                    color: #e53935;
                }
                .lottie-container {
                    margin-bottom: 0.5em;
                }
                .catchy-title {
                    letter-spacing: 0.01em;
                    text-shadow: 0 2px 8px #b2f5ea;
                }
                .catchy-discount {
                    letter-spacing: 0.02em;
                    text-shadow: 0 2px 12px #ffb3b3;
                }
                @media (max-width: 480px) {
                    .coupon-success-popup-content {
                        min-width: 90vw;
                        padding: 18px 6vw 18px 6vw;
                    }
                }
            </style>
<!-- Add this debug section temporarily -->
            <!-- Address Modal -->         
         
                

        </main>
    <!-- End of PageContent -->
    <footer class="footer footer_type_2 dark">


        <div class="footer-middle container">
          <div class="row row-cols-lg-5 row-cols-2">
            <div class="footer-column footer-store-info col-12 mb-4 mb-lg-0 d-flex flex-column align-items-center justify-content-center" style="min-height: 100%;">
              <div class="mb-3">
                <img class="footer-logo" src="images/stayrare/footer-logo.png" alt="">
              </div>
              <p class="m-0 mb-2 text-center">
                <a style="color: white;" href="mailto:stayrareofficial@gmail.com">âœ‰ï¸ <strong
                    class="fw-medium">stayrareofficial@gmail.com</strong></a>
              </p>
              <p class="mb-0 text-center">
                <a style="color: white;" href="tel:+916238669487">
                  <svg width="16" height="16" viewBox="0 0 24 24"
                    fill="white" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M6.62 10.79a15.05 15.05 0 006.59 6.59l2.2-2.2a1 1 0 011.05-.24c1.12.37 2.33.57 3.54.57a1 1 0 011 1v3.5a1 1 0 01-1 1C10.07 21 3 13.93 3 5.5a1 1 0 011-1H7.5a1 1 0 011 1c0 1.21.2 2.42.57 3.54a1 1 0 01-.24 1.05l-2.2 2.2z" />
                  </svg>
                  <strong class="fw-medium">+91 62 38669 487</strong>
                </a>
              </p>
            </div><!-- /.footer-column -->
    
            <div class="footer-column footer-menu mb-4 mb-lg-0">
              <h6 class="sub-menu__title text-uppercase">Company</h6>
              <ul class="sub-menu__list list-unstyled">
                <li class="sub-menu__item"><a href="/" class="menu-link menu-link_us-s">Home</a></li>
                <li class="sub-menu__item"><a href="/about" class="menu-link menu-link_us-s">About Us</a></li>
                <li class="sub-menu__item"><a href="/wishlist" class="menu-link menu-link_us-s">Wishlist</a></li>
                <li class="sub-menu__item"><a href="/blogs" class="menu-link menu-link_us-s">Blogs</a></li>
                <li class="sub-menu__item"><a href="/contact" class="menu-link menu-link_us-s">Contact Us</a></li>
              </ul>
            </div><!-- /.footer-column -->
    
            <div class="footer-column footer-menu mb-4 mb-lg-0">
              <h6 class="sub-menu__title text-uppercase">Shop</h6>
              <ul class="sub-menu__list list-unstyled">
                <li class="sub-menu__item"><a href="/store" class="menu-link menu-link_us-s">New Arrivals</a></li>
                <li class="sub-menu__item"><a href="/store" class="menu-link menu-link_us-s">Best Deals</a></li>
                <li class="sub-menu__item"><a href="/store" class="menu-link menu-link_us-s">Best Seller</a></li>
                <li class="sub-menu__item"><a href="/store" class="menu-link menu-link_us-s">Top Rated</a></li>
                <li class="sub-menu__item"><a href="/store" class="menu-link menu-link_us-s">Shop All</a></li>
              </ul>
            </div><!-- /.footer-column -->
    
            <div class="footer-column footer-menu mb-4 mb-lg-0">
              <h6 class="sub-menu__title text-uppercase">Help</h6>
              <ul class="sub-menu__list list-unstyled">
                <li class="sub-menu__item"><a href="/return_policy" class="menu-link menu-link_us-s">Return & Refund
                    Policy</a></li>
                <li class="sub-menu__item"><a href="/account" class="menu-link menu-link_us-s">My Account</a></li>
                <li class="sub-menu__item"><a href="/terms_and_conditions" class="menu-link menu-link_us-s">Terms &
                    Conditions</a></li>
                <li class="sub-menu__item"><a href="/privacy_policy" class="menu-link menu-link_us-s">Legal & Privacy</a>
                </li>
                <li class="sub-menu__item"><a href="/shipping_policy" class="menu-link menu-link_us-s">Shipping Policy</a>
                </li>
    
              </ul>
            </div><!-- /.footer-column -->
            <div class="footer-column footer-newsletter col-12 mb-4 mb-lg-0">
                <h5 class="sub-menu__title text-uppercase">Subscribe</h5>
                <p>Donâ€™t miss a drop get product alerts, restock updates, and more delivered directly to you!</p>
                <form action="#"
                  class="footer-newsletter__form position-relative bg-body">
                  <input class="form-control border-white" type="email" name="email" placeholder="Your email address">
                  <input class="btn-link fw-medium bg-white position-absolute top-0 end-0 h-100" type="submit" value="JOIN">
                </form>
                <ul class="social-links list-unstyled d-flex flex-wrap mb-0 mt-3">
                  <li>
                    <a href="https://www.facebook.com/profile.php?id=61578094636322 " class="footer__social-link d-block">
                      <svg class="svg-icon svg-icon_facebook" width="9" height="15" viewBox="0 0 9 15"
                        xmlns="http://www.w3.org/2000/svg">
                        <use href="#icon_facebook" />
                      </svg>
                    </a>
                  </li>
               
                  <li>
                    <a href="https://www.instagram.com/stayrare.in?igsh=MXZ6ZzlpcjVod3Nscw=="
                      class="footer__social-link d-block">
                      <svg class="svg-icon svg-icon_instagram" width="14" height="13" viewBox="0 0 14 13"
                        xmlns="http://www.w3.org/2000/svg">
                        <use href="#icon_instagram" />
                      </svg>
                    </a>
                  </li>
               
                </ul>
      
      
              </div><!-- /.footer-column -->
          </div><!-- /.row-cols-5 -->
        </div><!-- /.footer-middle container -->
    
        <div class="footer-bottom">
          <div class="container d-md-flex align-items-center">
            <span class="footer-copyright me-auto">Copyright Â© 2025 StayRare. All Rights Reserved. 
            </span>
    
          </div><!-- /.container d-flex align-items-center -->
        </div><!-- /.footer-bottom container -->
      </footer>

  <!-- Mobile Fixed Footer -->
  <footer class="footer-mobile container w-100 px-5 d-md-none bg-body">
    <div class="row text-center">
      <div class="col-3">
        <a href="/" class="footer-mobile__link d-flex flex-column align-items-center">
          <img style="width: 25px; height: 25px;" src="/images/home-icon.png" alt="stayrare">
          <span>Home</span>
        </a>
      </div><!-- /.col-3 -->

      <div class="col-3">
        <a href="/store" class="footer-mobile__link d-flex flex-column align-items-center">
          <img style="width: 25px; height: 25px;" src="/images/shop-icon.png" alt="stayrare">
          <span>Shop</span>
        </a>
      </div><!-- /.col-3 -->
      <div class="col-3">
        <a href="/wishlist" class="footer-mobile__link d-flex flex-column align-items-center">
          <div class="position-relative">
                    <svg class="d-block" width="20" height="20" viewBox="0 0 20 20" fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <use href="#icon_heart" />
          </svg>
          </div>
          <span>Wishlist</span>
        </a>
      </div><!-- /.col-3 -->
            <div class="col-3">
        <a href="<%= user ? '/account' : '/auth/login' %>" class="footer-mobile__link d-flex flex-column align-items-center">
          <div class="position-relative">
                            <svg width="20" height="20": class="icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                <circle cx="12" cy="7" r="4"/>
            </svg>
          </div>
          <span>Account</span>
        </a>
      </div><!-- /.col-3 -->
    </div><!-- /.row -->
  </footer><!-- /.footer-mobile container position-fixed d-md-none bottom-0 -->

    <!-- End of Footer -->
    </div>
    <!-- End of Page Wrapper -->







  <div id="scrollTop" class="visually-hidden end-0"></div>
    <script>
        window.isLoggedIn = <%= user ? 'true' : 'false' %>;
    </script>
    <!-- End of Mobile Menu -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

    <!-- Plugin JS File -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

     <script src="/js/plugins/jquery.min.js"></script>
  <script src="/js/plugins/bootstrap.bundle.min.js"></script>
  <script src="/js/plugins/bootstrap-slider.min.js"></script>
  
  <script src="/js/plugins/swiper.min.js"></script>
  <script src="/js/plugins/countdown.js"></script>
  <script src="/js/plugins/jquery.fancybox.js"></script>
  <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.6.2/dist/dotlottie-wc.js" type="module"></script>
  <!-- Footer Scripts -->
  <script src="/js/theme.js"></script>
     <script>
        // Fallback: If SVG doesn't render, this script will replace them with Unicode symbols
        document.addEventListener('DOMContentLoaded', function() {
            const icons = document.querySelectorAll('.icon-svg');
            let allSvgsLoaded = true;
            
            icons.forEach(function(icon) {
                if (icon.getBBox && icon.getBBox().width === 0) {
                    allSvgsLoaded = false;
                }
            });
            
            if (!allSvgsLoaded) {
                // Replace with Unicode fallbacks
                const iconContainer = document.querySelector('.icon-container');
                if (iconContainer) {
                    iconContainer.innerHTML = `
                        <div class="icon">
                            <div style="font-size: 24px; line-height: 32px; text-align: center;">ðŸ‘¤</div>
                            <div class="badge">5</div>
                        </div>
                        <div class="icon">
                            <div style="font-size: 24px; line-height: 32px; text-align: center;">â¤ï¸</div>
                            <div class="badge">2</div>
                        </div>
                        <div class="icon">
                            <div style="font-size: 24px; line-height: 32px; text-align: center;">ðŸ›ï¸</div>
                            <div class="badge">3</div>
                        </div>
                    `;
                }
            }
        });
    </script>
</body>



</html>